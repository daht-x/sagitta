name: "Documentation"
on:
  pull_request:
    paths:
      - "**.md"
  schedule:
    - cron: "0 0 */2 * *"
  workflow_dispatch:
concurrency:
  group: "${{ github.workflow }}-${{ github.ref }}"
  cancel-in-progress: true
jobs:
  linter:
    name: "Linter"
    if: "${{ github.event_name == 'pull_request' }}"
    runs-on: "${{ vars.DEFAULT_UBUNTU }}"
    steps:
      - name: "Set up workspace"
        uses: "actions/checkout@v4.1.1"
      - name: "Run linter"
        uses: "avto-dev/markdown-lint@v1.5.0"
        with:
          args: "**.md"
  link-checker:
    name: "Link checker"
    runs-on: "${{ vars.DEFAULT_UBUNTU }}"
    env:
      IS_PULL_REQUEST_EVENT: "${{ github.event_name == 'pull_request' }}"
      IS_SCHEDULE_OR_WORKFLOW_DISPATCH_EVENT: "${{ github.event_name == 'schedule' || github.event_name == 'workflow_dispatch' }}"
      POSITIVE_RESPONSE: "true"
      MARKDOWN_LINK_CHECK_FILE: ".markdownlc.json"
    steps:
      - name: "Set up workspace"
        if: "${{ env.IS_PULL_REQUEST_EVENT == env.POSITIVE_RESPONSE }}"
        uses: "actions/checkout@v4.1.1"
      - name: "Set up workspace"
        if: "${{ env.IS_SCHEDULE_OR_WORKFLOW_DISPATCH_EVENT == env.POSITIVE_RESPONSE }}"
        uses: "actions/checkout@v4.1.1"
        with:
          fetch-depth: 0
      - name: "Run link checker"
        if: "${{ env.IS_PULL_REQUEST_EVENT == env.POSITIVE_RESPONSE }}"
        uses: "gaurav-nelson/github-action-markdown-link-check@1.0.15"
        with:
          base-branch: "${{ github.ref_name }}"
          check-modified-files-only: true
          use-quiet-mode: true
          config-file: "${{ env.MARKDOWN_LINK_CHECK_FILE }}"
      - name: "Run link checker"
        if: "${{ env.IS_SCHEDULE_OR_WORKFLOW_DISPATCH_EVENT == env.POSITIVE_RESPONSE }}"
        uses: "gaurav-nelson/github-action-markdown-link-check@1.0.15"
        with:
          base-branch: "${{ github.ref_name }}"
          use-quiet-mode: true
          config-file: "${{ env.MARKDOWN_LINK_CHECK_FILE }}"
